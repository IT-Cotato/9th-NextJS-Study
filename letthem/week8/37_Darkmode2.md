# Dark mode ê¸°ëŠ¥ 2

1. í˜„ì¬ UIì˜ ìƒíƒœë¥¼ cookieì— ì €ì¥í•´ë‘ 
2. cookieì— ë”°ë¼ì„œ UIê°€ ì–´ë–»ê²Œ ë³€í• ì§€ ì‘ì„±
3. í•„ìš”í•  ë•Œ cookie ë³€ê²½

ì¿ í‚¤ ìƒì„±ì€ ì„œë²„ API ì½”ë“œë‚˜ Middlewareë¡œë„ ê°€ëŠ¥!!

modeë¼ëŠ” ì´ë¦„ì˜ ì¿ í‚¤ë‚´ìš© ì¶œë ¥í•´ì¤Œ!!
let ì¿ í‚¤ê°’ = ('; '+document.cookie).split(`; mode=`).pop().split(';')[0]

DarkMode.js â¬‡ï¸

```javascript
"use client";

import { useEffect } from "react";

export default function DarkMode() {
  useEffect(() => {
    let ì¿ í‚¤ê°’ = ("; " + document.cookie).split(`; mode=`).pop().split(";")[0];
    if (ì¿ í‚¤ê°’ == "") {
      document.cookie = "mode=light; max-age=" + 3600 * 24 * 400;
    }
  }, []);
  return <span onClick={() => {}}> ğŸŒ™ </span>;
}
```

globals.css â¬‡ï¸

```css
.dark-mode .navbar {
  background: #222;
}

.dark-mode .navbar a {
  color: white;
}
```

layout.js â¬‡ï¸

```javascript
import { Inter } from "next/font/google";
import Link from "next/link";
import "./globals.css";
import LoginBtn from "./LoginBtn";
import LogoutBtn from "./LogoutBtn";
import { authOptions } from "@/pages/api/auth/[...nextauth]";
import { getServerSession } from "next-auth";
import DarkMode from "./DarkMode";
import { cookies } from "next/headers";

const inter = Inter({ subsets: ["latin"] });

export const metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default async function RootLayout({ children }) {
  let session = await getServerSession(authOptions);

  let res = cookies().get("mode");
  console.log(res.value);

  return (
    <html lang="en">
      <body
        className={res != undefined && res.value == "dark" ? "dark-mode" : ""}
      >
        <div className="navbar">
          <Link href="/" className="logo">
            Letthem Forum
          </Link>
          <Link href="/list">List</Link>
          {session ? (
            <span>
              {session.user.name}
              <LogoutBtn />
            </span>
          ) : (
            <LoginBtn />
          )}
          <DarkMode />
        </div>
        {children}
      </body>
    </html>
  );
}
```

DarkMode.js â¬‡ï¸

```javascript
"use client";

import { useRouter } from "next/navigation";
import { useEffect } from "react";

export default function DarkMode() {
  let router = useRouter();
  useEffect(() => {
    let ì¿ í‚¤ê°’ = ("; " + document.cookie).split(`; mode=`).pop().split(";")[0];
    if (ì¿ í‚¤ê°’ == "") {
      document.cookie = "mode=light; max-age=" + 3600 * 24 * 400;
    }
  }, []);
  return (
    <span
      onClick={() => {
        let ì¿ í‚¤ê°’ = ("; " + document.cookie)
          .split(`; mode=`)
          .pop()
          .split(";")[0];
        if (ì¿ í‚¤ê°’ == "light") {
          document.cookie = "mode=dark; max-age=" + 3600 * 24 * 400;
          router.refresh();
        } else {
          document.cookie = "mode=light; max-age=" + 3600 * 24 * 400;
          router.refresh();
        }
      }}
    >
      {" "}
      ğŸŒ™{" "}
    </span>
  );
}
```

> ì¿ í‚¤ ë°”ê¾¼ë‹¤ê³  ìë™ ì¬ë Œë”ë§ ì•ˆ ë¨!
> ìƒˆë¡œê³ ì¹¨ì€ router.refresh()

ê²°ë¡  &rarr; ì¬ì ‘ì†ì‹œ ìœ ì§€ë˜ê²Œ í•˜ë ¤ë©´ DB/localStorage/cookie

# íšŒì›ê¸°ëŠ¥ ë§Œë“¤ê¸° : Auth.js ì‚¬ìš©í•œ ì†Œì…œë¡œê·¸ì¸

### ì†Œì…œë¡œê·¸ì¸ - ì•„ì´ë””/ë¹„ë²ˆê´€ë¦¬ í•„ìš” ì—†ìŒ. ì½”ë“œ ì§¤ ê²ƒë„ ì—†ìŒ

## 1. Github ê³„ì • ì†Œì…œë¡œê·¸ì¸ í•´ë³´ê² ë‹¤!

> Github ì†Œì…œë¡œê·¸ì¸ í—ˆë½ë°›ê¸° - settings>developer settings>OAuth ë“±ë¡!

## 2. next-auth ì„¤ì¹˜

> npm install next-auth@latest

## 3. pages/api/auth/[...nextauth].js ë§Œë“¤ê¸°

```javascript
import NextAuth from "next-auth";
import GithubProvider from "next-auth/providers/github";

export const authOptions = {
  providers: [
    GithubProvider({
      clientId: "Githubì—ì„œ ë°œê¸‰ë°›ì€ ID",
      clientSecret: "Githubì—ì„œ ë°œê¸‰ë°›ì€ Secret",
    }),
  ],
  secret: "jwtìƒì„±ì‹œ ì“°ëŠ” ì•”í˜¸",
};

export default NextAuth(authOptions);
```

## 4. layout.jsì— ë¡œê·¸ì¸ ë²„íŠ¼ ì¶”ê°€. but, onClick ì¨ì•¼í•¨. client ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ì..

app/LoginBtn.js ë§Œë“¤ì–´ì„œ

```javascript
"use client";

import { signIn, signOut } from "next-auth/react";

export default function LoginBtn() {
  return (
    <button
      onClick={() => {
        signIn();
      }}
    >
      ë¡œê·¸ì¸
    </button>
  );
}
```

ì‹¤í–‰ë˜ë©´ ë¡œê·¸ì¸ í˜ì´ì§€ ìë™ ì´ë™!! ë§¤ìš° í¸ë¦¬í•˜ë‹¤ ğŸ˜Š
ë¡œê·¸ì•„ì›ƒì€ signOut() !!

## 5. ë¡œê·¸ì¸ëœ ìœ ì € ì •ë³´ ì¶œë ¥

> await getServerSession(authOptions) : ì„œë²„ ì»´í¬ë„ŒíŠ¸, ì„œë²„ ê¸°ëŠ¥ ì•ˆì—ì„œ ì‚¬ìš© ê°€ëŠ¥

layout.js â¬‡ï¸

```javascript
import { Inter } from "next/font/google";
import Link from "next/link";
import "./globals.css";
import LoginBtn from "./LoginBtn";
import { authOptions } from "@/pages/api/auth/[...nextauth]";

const inter = Inter({ subsets: ["latin"] });

export const metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default async function RootLayout({ children }) {
  let session = await getServerSession(authOptions);
  console.log(session);
  return (
    <html lang="en">
      <body>
        <div className="navbar">
          <Link href="/" className="logo">
            Letthem Forum
          </Link>
          <Link href="/list">List</Link>
          <LoginBtn />
        </div>
        {children}
      </body>
    </html>
  );
}
```

---

â“ Q. í˜„ì¬ ë¡œê·¸ì¸ëœ ìœ ì € ì •ë³´ê°€ ìˆì„ ê²½ìš° ìƒë‹¨ë°”ì— ìœ ì €ì´ë¦„ & ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ë³´ì—¬ì£¼ê³  ìœ ì € ì •ë³´ê°€ ì—†ì„ ê²½ìš° ìƒë‹¨ë°”ì— ë¡œê·¸ì¸ ë²„íŠ¼ ë³´ì—¬ì£¼ë ¤ë©´?

ğŸ’¡ hint : JSX ì•ˆì—ì„œ if ì“°ê³  ì‹¶ìœ¼ë©´ ì‚¼í•­ ì—°ì‚°ì ì‚¬ìš©í•˜ì

```javascript
{
  ì¡°ê±´ì‹ ? ì¡°ê±´ì‹ ì°¸ì¼ ë•Œ ì‹¤í–‰í•  ì½”ë“œ : ê±°ì§“ì¼ ë•Œ ì‹¤í–‰í•  ì½”ë“œ
}
```

ğŸ˜Š A.

```javascript
import { Inter } from "next/font/google";
import Link from "next/link";
import "./globals.css";
import LoginBtn from "./LoginBtn";
import LogoutBtn from "./LogoutBtn";
import { authOptions } from "@/pages/api/auth/[...nextauth]";
import { getServerSession } from "next-auth";

const inter = Inter({ subsets: ["latin"] });

export const metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default async function RootLayout({ children }) {
  let session = await getServerSession(authOptions);

  return (
    <html lang="en">
      <body>
        <div className="navbar">
          <Link href="/" className="logo">
            Letthem Forum
          </Link>
          <Link href="/list">List</Link>
          {session ? (
            <span>
              {session.user.name}
              <LogoutBtn />
            </span>
          ) : (
            <LoginBtn />
          )}
        </div>
        {children}
      </body>
    </html>
  );
}
```
